var L=Object.defineProperty,v=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var x=(e,t,r)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,b=(e,t)=>{for(var r in t||(t={}))U.call(t,r)&&x(e,r,t[r]);if(T)for(var r of T(t))Y.call(t,r)&&x(e,r,t[r]);return e},E=(e,t)=>v(e,B(t));var S=(e,t,r)=>new Promise((s,n)=>{var o=p=>{try{i(r.next(p))}catch(c){n(c)}},a=p=>{try{i(r.throw(p))}catch(c){n(c)}},i=p=>p.done?s(p.value):Promise.resolve(p.value).then(o,a);i((r=r.apply(e,t)).next())});var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",k=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/;function O(e){e=String(e);for(var t,r,s,n,o="",a=0,i=e.length%3;a<e.length;){if((r=e.charCodeAt(a++))>255||(s=e.charCodeAt(a++))>255||(n=e.charCodeAt(a++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");t=r<<16|s<<8|n,o+=m.charAt(t>>18&63)+m.charAt(t>>12&63)+m.charAt(t>>6&63)+m.charAt(t&63)}return i?o.slice(0,i-3)+"===".substring(i):o}function C(e){if(e=String(e).replace(/[\t\n\f\r ]+/g,""),!k.test(e))throw new TypeError("Failed to execute 'atob' on 'Window': The string to be decoded is not correctly encoded.");e+="==".slice(2-(e.length&3));for(var t,r="",s,n,o=0;o<e.length;)t=m.indexOf(e.charAt(o++))<<18|m.indexOf(e.charAt(o++))<<12|(s=m.indexOf(e.charAt(o++)))<<6|(n=m.indexOf(e.charAt(o++))),r+=s===64?String.fromCharCode(t>>16&255):n===64?String.fromCharCode(t>>16&255,t>>8&255):String.fromCharCode(t>>16&255,t>>8&255,t&255);return r}var P="2.8.3";var w=(o=>(o.REQUIRED_FIELD_MISSING="REQUIRED_FIELD_MISSING",o.REQUIRED_FIELD_EMPTY="REQUIRED_FIELD_EMPTY",o.TYPE_EMAIL="TYPE_EMAIL",o.TYPE_NUMERIC="TYPE_NUMERIC",o.TYPE_TEXT="TYPE_TEXT",o))(w||{});function $(e){return e.code in w&&e.field!==void 0}function F(e){return e.errors!==void 0}var A=e=>O(JSON.stringify(e));var D=e=>{let t=`@formspree/core@${P}`;return e?`${e} ${t}`:t},M=()=>1*new Date,h=(e,t,r)=>{e instanceof FormData?e.append(t,r):e=Object.assign(e,{[t]:r})},N=p=>S(void 0,[p],function*({stripePromise:e,response:t,responseData:r,payload:s,data:n,fetchImpl:o,request:a,url:i}){let c=yield e.handleCardAction(r.stripe.paymentIntentClientSecret);if(c.error)return{response:t,body:{errors:[{code:"STRIPE_CLIENT_ERROR",message:"Stripe SCA error",field:"paymentMethod"}]}};{s.paymentMethod.id||h(n,"paymentMethod",s.paymentMethod.id),h(n,"paymentIntent",c.paymentIntent.id),h(n,"resubmitKey",r.resubmitKey);let l=yield o(i,E(b({},a),{body:JSON.stringify({paymentIntent:c.paymentIntent.id,resubmitKey:r.resubmitKey})})),u=yield l.json();return{response:l,body:u}}});function I({body:e,response:t}){return!F(e)&&(e!=null&&e.error)&&(e={errors:[{message:e.error}]}),{body:e,response:t}}var z=()=>navigator.webdriver||!!document.documentElement.getAttribute(C("d2ViZHJpdmVy"))||!!window.callPhantom||!!window._phantom,g=class{constructor(){this.loadedAt=M(),this.webdriver=z()}teardown(){}data(){return{loadedAt:this.loadedAt,webdriver:this.webdriver}}};var R=class{constructor(t={}){this.project=t.project,this.stripePromise=t.stripePromise,typeof window!="undefined"&&this.startBrowserSession()}startBrowserSession(){this.session||(this.session=new g)}teardown(){this.session&&this.session.teardown()}submitForm(n,o){return S(this,arguments,function*(t,r,s={}){let a=s.endpoint||"https://formspree.io",i=s.fetchImpl||fetch,p=this.project?`${a}/p/${this.project}/f/${t}`:`${a}/f/${t}`,c=d=>d instanceof FormData?d:JSON.stringify(d),l={Accept:"application/json","Formspree-Client":D(s.clientName)};this.session&&(l["Formspree-Session-Data"]=A(this.session.data())),r instanceof FormData||(l["Content-Type"]="application/json");let u={method:"POST",mode:"cors",body:c(r),headers:l};if(this.stripePromise&&s.createPaymentMethod){let d=yield s.createPaymentMethod();if(d.error)return{response:null,body:{errors:[{code:"STRIPE_CLIENT_ERROR",message:"Error creating payment method",field:"paymentMethod"}]}};h(r,"paymentMethod",d.paymentMethod.id);let y=yield i(p,E(b({},u),{body:r})),f=yield y.json();return f&&f.stripe&&f.stripe.requiresAction&&f.resubmitKey?yield N({stripePromise:this.stripePromise,responseData:f,response:y,payload:d,data:r,fetchImpl:i,request:u,url:p}):I({response:y,body:f})}else return i(p,u).then(d=>d.json().then(y=>I({body:y,response:d}))).catch()})}},j=e=>new R(e),J=()=>(_||(_=j()),_),_;export{R as Client,j as createClient,J as getDefaultClient,$ as isFieldError};
