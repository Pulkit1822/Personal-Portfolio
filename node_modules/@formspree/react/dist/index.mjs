import n,{useEffect as E,useState as C,useContext as U,lazy as k,Suspense as H}from"react";import{createClient as K,getDefaultClient as N}from"@formspree/core";import{loadStripe as z}from"@stripe/stripe-js/pure.js";var B=k(()=>import("@stripe/react-stripe-js").then(r=>({default:r.Elements}))),b=n.createContext(null);b.displayName="Formspree";var x,O=r=>(x||(x=z(r)),x),D=(r,o)=>{let i={};return r&&(i.stripePromise=r),o&&(i.project=o),K(i)},I=r=>{let[o,i]=C(void 0),[p,c]=C(D(o,r.project));return E(()=>(p.startBrowserSession(),()=>{p.teardown()}),[]),E(()=>{let a=async u=>{let l=await O(u);l&&i(l)};r.stripePK&&a(r.stripePK)},[r.stripePK]),E(()=>{o&&c(D(o,r.project))},[o]),n.createElement(b.Provider,{value:{client:p}},r.stripePK?n.createElement(n.Fragment,null,o&&n.createElement(H,{fallback:n.createElement("p",null,"....")},n.createElement(B,{stripe:o},n.createElement(n.Fragment,null,r.children)))):n.createElement(n.Fragment,null,r.children))};function S(){return U(b)??{client:N()}}import{useState as F}from"react";import{useElements as Y,CardElement as w,useStripe as G}from"@stripe/react-stripe-js";var _="2.4.4";var $=r=>r.preventDefault!==void 0,q=(r,o={})=>{let[i,p]=F(null),[c,a]=F(!1),[u,l]=F(!1),[j,f]=F([]),d=S(),T=o.client||d,P,h;if(!T)throw new Error("You must provide a Formspree client");if(!r)throw new Error('You must provide a form key or hashid (e.g. useForm("myForm") or useForm("123xyz")');d.client&&d.client.stripePromise&&(P=G(),h=Y());let y=!!o.debug,v=o.data;return[{result:i,submitting:c,succeeded:u,errors:j},async g=>{let R=async t=>{t.preventDefault();let s=t.target;if(s.tagName!="FORM")throw new Error("submit was triggered for a non-form element");return new FormData(s)},e=$(g)?await R(g):g,V=(t,s)=>{e instanceof FormData?e.append(t,s):e=Object.assign(e,{[t]:s})};if(typeof v=="object")for(let[t,s]of Object.entries(v)){let m;typeof s=="function"?m=await s():m=s,m!==void 0&&V(t,m)}let M=async()=>{let t={...e.address_line1&&{line1:e.address_line1},...e.address_line2&&{line2:e.address_line2},...e.address_city&&{city:e.address_city},...e.address_country&&{country:e.address_country},...e.address_state&&{state:e.address_state},...e.address_postal_code&&{postal_code:e.address_postal_code}};return await P.createPaymentMethod({type:"card",card:h.getElement(w),billing_details:{...e.name&&{name:e.name},...e.email&&{email:e.email},...e.phone&&{phone:e.phone},...t&&{address:t}}})};return a(!0),d.client.submitForm(r,e,{endpoint:o.endpoint,clientName:`@formspree/react@${_}`,createPaymentMethod:d.client&&d.client.stripePromise?M:void 0}).then(t=>{let s=t.response.status,m;return s===200?(y&&console.log("Form submitted",t),l(!0),p(t),f([])):s>=400&&(m=t.body,m.errors?(f(m.errors),y&&console.log("Error",t)):(f([{message:"Unexpected error"}]),y&&console.log("Unexpected error",t)),l(!1)),t}).catch(t=>{throw y&&console.log("Unexpected error",t),l(!1),t}).finally(()=>{a(!1)})},()=>{a(!1),l(!1),f([])}]};import A from"react";var J=r=>{let{prefix:o,field:i,errors:p,...c}=r,a=(p||[]).find(u=>u.field===i);return a?A.createElement("div",{...c},o," ",a.message):null};import{isFieldError as ye}from"@formspree/core";export{w as CardElement,I as FormspreeProvider,J as ValidationError,ye as isFieldError,q as useForm,S as useFormspree};
