"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),r=require("react"),t=require("@react-three/fiber"),u=require("react-merge-refs"),n=require("./useFBO.cjs.js");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function c(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var u=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,u.get?u:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}require("three");var o=a(e),s=c(r),i=a(u);const l=s.forwardRef((({envMap:e,resolution:r=256,frames:u=1/0,children:a,makeDefault:c,...l},f)=>{const d=t.useThree((({set:e})=>e)),g=t.useThree((({camera:e})=>e)),h=t.useThree((({size:e})=>e)),b=s.useRef(null),m=s.useRef(null),p=n.useFBO(r);s.useLayoutEffect((()=>{l.manual||b.current.updateProjectionMatrix()}),[h,l]),s.useLayoutEffect((()=>{b.current.updateProjectionMatrix()})),s.useLayoutEffect((()=>{if(c){const e=g;return d((()=>({camera:b.current}))),()=>d((()=>({camera:e})))}}),[b,c,d]);let j=0,O=null;const y="function"==typeof a;return t.useFrame((r=>{y&&(u===1/0||j<u)&&(m.current.visible=!1,r.gl.setRenderTarget(p),O=r.scene.background,e&&(r.scene.background=e),r.gl.render(r.scene,b.current),r.scene.background=O,r.gl.setRenderTarget(null),m.current.visible=!0,j++)})),s.createElement(s.Fragment,null,s.createElement("orthographicCamera",o.default({left:h.width/-2,right:h.width/2,top:h.height/2,bottom:h.height/-2,ref:i.default([b,f])},l),!y&&a),s.createElement("group",{ref:m},y&&a(p.texture)))}));exports.OrthographicCamera=l;
